<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.huangtl.blogmgr.model.blog.User">
	<resultMap id="map" type="com.huangtl.blogmgr.model.blog.User" >
		<id property="fId" column="ui_Id"/>
		<result property="fName" column="ui_Name"/>
		<result property="fAccount" column="ui_Account" />
		<result property="fPassword" column="ui_Password"/>
		<result property="fStatus" column="dic_Status"/>
		<result property="fPinYin" column="ui_PinYin"/>
		<result property="fEmail" column="ui_Email"/>
		<result property="fGender" column="dic_Gender"/>
		<result property="fPhone" column="ui_Phone"/>
		<result property="fDescr" column="ui_Descr"/>
		<result property="fCreater" column="ui_Creater"/>
		<result property="fCreateDate" column="ui_CreateDate"/>
		<result property="fEditor" column="ui_Editor"/>
		<result property="fEditDate" column="ui_EditDate"/>
	</resultMap>
	
	<sql id="field">
		ui_Id,ui_Name,ui_Account,dic_Status,ui_Email,ui_Phone
		<if test="fPassword_show">,ui_Password</if>
		<if test="fGender_show">,dic_Gender</if>
		<if test="fPinYin_show">,ui_PinYin</if>
		<if test="fDescr_show">,ui_Descr</if>
		<if test="fEditor_show">,ui_Editor</if>
		<if test="fEditDate_show">,ui_EditDate as fEditDate</if>
		<if test="fCreater_show">,ui_Creater</if>
		<if test="fCreateDate_show">,ui_CreateDate as fCreateDate</if>
	</sql>
	
	<sql id="where">
		 <trim prefix="where" prefixOverrides="and|or">
		 	<if test="defaultWhere!=null and defaultWhere">
		 		1=1
		 	</if>
			<if test="fId_eq != null ">and         ui_Id       =   #{fId_eq}</if>
			<if test="fName_like != null">and      ui_Name    like #{fName_like}</if>
			<if test="fPinYin_like != null">and    ui_PinYin  like #{fPinYin_like}</if>
			<if test="fAccount_like != null ">and  ui_Account like #{fAccount_like}</if>
			<if test="fAccount_eq != null ">and    ui_Account  =   #{fAccount_eq}</if>
			<if test="fPhone_eq != null ">and      ui_Phone    =   #{fPhone_eq}</if>
			<if test="fPhone_like != null">and     ui_Phone   like #{fPhone_like}</if>
			<if test="fEmail_eq != null ">and      ui_Email    =   #{fEmail_eq}</if>
			<if test="fGender_eq != null ">and     dic_Gender  =   #{fGender_eq}</if>
			<if test="fStatus_eq != null">and      dic_Status  =   #{fStatus_eq}</if>
			<if test="fStatus_ne != null">and      dic_Status !=   #{fStatus_ne}</if>
			<if test="fCreateDate_eq != null">and  DATE_FORMAT(ui_createDate,'%Y-%m-%d') =  #{fCreateDate_eq}</if>
			<if test="fCreateDate_gt != null">and  DATE_FORMAT(ui_createDate,'%Y-%m-%d') &gt;  #{fCreateDate_gt}</if>
			<if test="fCreateDate_lt != null">and  DATE_FORMAT(ui_createDate,'%Y-%m-%d') &lt;  #{fCreateDate_lt}</if>
			<if test="fId_in != null">
				and ui_Id in
				<foreach collection="fId_in" open="(" item="id" separator="," close=")">
					#{id}
				</foreach>
			</if>
			<if test="fStatus_in != null ">
				and dic_Status in 
				<foreach collection="fStatus_in" open="(" item="status" separator="," close=")">
					#{status}
				</foreach>
			</if>
		</trim>
	</sql>
	
	<sql id="order">
		<if test="sorts != null and sorts.size() != 0">
			order by 
			<foreach collection="sorts" separator="," index="key" item="val">
				${key} ${val}
			</foreach>
		</if>
	</sql>
	
	<insert id="insert" parameterType="com.huangtl.blogmgr.model.blog.Menu">
		insert into mgr_userinfo(
			ui_Id,ui_Name,ui_Account,ui_Password,ui_PinYin,ui_Creater,ui_CreateDate
			<if test="fStatus !=null">,dic_Status</if>
			<if test="fGender !=null">,dic_Gender</if>
			<if test="fPhone !=null">,ui_Phone</if>
			<if test="fEmail !=null">,ui_Email</if>
			<if test="fDescr !=null">,ui_Descr</if>
			<if test="fEditor !=null">,ui_Editor</if>
			<if test="fEditDate !=null">,ui_EditDate</if>
		) values(
			#{fId},#{fName},#{fAccount},#{fPassword},#{fPinYin},#{fCreater},#{fCreateDate}
			<if test="fStatus !=null">,#{fStatus}</if>
			<if test="fGender !=null">,#{fGender}</if>
			<if test="fPhone !=null">,#{fPhone}</if>
			<if test="fEmail !=null">,#{fEmail}</if>
			<if test="fDescr !=null">,#{fDescr}</if>
			<if test="fEditor !=null">,#{fEditor}</if>
			<if test="fEditDate !=null">,#{fEditDate}</if>
		);
	</insert>
	
	<update id="update" parameterType="map">
		update mgr_userinfo 
		<trim prefix="set" suffixOverrides=",">
			<if test="fName !=null">ui_Name = #{fName},</if>
			<if test="fPassword !=null">ui_Password = #{fPassword},</if>
			<if test="fStatus !=null">dic_Status = #{fStatus},</if>
			<if test="fPinYin !=null">ui_PinYin = #{fPinYin},</if>
			<if test="fDescr !=null">ui_Descr = #{fDescr},</if>
			<if test="fEditor !=null">ui_Editor = #{fEditor},</if>
			<if test="fEditDate !=null">ui_EditDate = #{fEditDate},</if>
			<if test="fEmail !=null">ui_Email = #{fEmail},</if>
			<if test="fPhone !=null">ui_Phone = #{fPhone},</if>
			<if test="fGender !=null">dic_Gender = #{fGender},</if>
		</trim>
		<include refid="where"/>
	</update>

	<update id="updateBatch" parameterType="list">
		<foreach collection="list" item="user" index="index" open="" close="" separator=";">
			update mgr_userinfo 
			<trim prefix="set" suffixOverrides=",">
				<if test="user.fName !=null">ui_Name = #{user.fName},</if>
				<if test="user.fPassword !=null">ui_Password = #{user.fPassword},</if>
				<if test="user.fStatus !=null">dic_Status = #{user.fStatus},</if>
				<if test="user.fPinYin !=null">ui_PinYin = #{user.fPinYin},</if>
				<if test="user.fDescr !=null">ui_Descr = #{user.fDescr},</if>
				<if test="user.fEditor !=null">ui_Editor = #{user.fEditor},</if>
				<if test="user.fEditDate !=null">ui_EditDate = #{user.fEditDate},</if>
				<if test="user.fEmail !=null">ui_Email = #{user.fEmail},</if>
				<if test="user.fPhone !=null">ui_Phone = #{user.fPhone},</if>
				<if test="user.fGender !=null">dic_Gender = #{user.fGender},</if>
			</trim>
			 where ui_Id = #{user.fId}
		</foreach>
	</update>

	<select id="selectList" resultMap="map" parameterType="map">
		select 
			<include refid="field"/>
		from mgr_userinfo
			<include refid="where"/>
	</select>
	
	<select id="selectCount"  resultType="long" parameterType="map">
	  select count(ui_Id) 
	  from mgr_userinfo
		<include refid="where"/>
	</select>
	
	<select id="selectPaging" resultMap="map" parameterType="map">
		select 
			<include refid="field"/>
		from mgr_userinfo
			<include refid="where"/>
			<include refid="order"/>
		limit #{startIndex},#{pageSize}
	</select>
	
	<delete id="delete" parameterType="map">
		delete from mgr_userinfo
			<include refid="where"/>
	</delete>
	
</mapper>